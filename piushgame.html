<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Flappy Bird</title>

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        width: 100vw;
        height: 100vh;
        background: #111;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        touch-action: manipulation;
    }

    #game-wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    canvas {
        background: #70c5ce;
        display: block;
    }
</style>
</head>

<body>

<div id="game-wrapper">
    <canvas id="canvas" width="400" height="600"></canvas>
</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

// Load Bird Image
const birdImg = new Image();
birdImg.src = 'https://uploads.onecompiler.io/449pen73h/449pdz7f6/WhatsApp%20Image%202026-01-05%20at%2014.06.33_c80b45f2.jpg';

// High Score (localStorage)
let highScore = localStorage.getItem('flappyHighScore') || 0;

// Game Variables
let bird, pipes, score, gameOver, frame;

function init() {
    bird = { x: 60, y: 250, vy: 0, w: 60, h: 60 };
    pipes = [];
    score = 0;
    gameOver = false;
    frame = 0;
}
init();

// Controls (PC + Mobile)
function jump() {
    if (gameOver) {
        init();
    } else {
        bird.vy = -8;
    }
}

document.addEventListener('keydown', e => {
    if (e.code === 'Space') jump();
});

canvas.addEventListener('click', jump);
canvas.addEventListener('touchstart', e => {
    e.preventDefault();
    jump();
});

// Update Game
function update() {
    if (gameOver) return;

    frame++;
    bird.vy += 0.4;
    bird.y += bird.vy;

    if (bird.y + bird.h > 520 || bird.y < 0) {
        endGame();
    }

    if (frame % 90 === 0) {
        pipes.push({
            x: canvas.width,
            top: Math.random() * 250 + 50,
            scored: false
        });
    }

    for (let i = pipes.length - 1; i >= 0; i--) {
        pipes[i].x -= 3;

        if (!pipes[i].scored && pipes[i].x + 52 < bird.x) {
            pipes[i].scored = true;
            score++;
        }

        if (
            bird.x < pipes[i].x + 52 &&
            bird.x + bird.w > pipes[i].x &&
            (bird.y < pipes[i].top ||
             bird.y + bird.h > pipes[i].top + 180)
        ) {
            endGame();
        }

        if (pipes[i].x + 52 < 0) {
            pipes.splice(i, 1);
        }
    }
}

// End Game + Save High Score
function endGame() {
    gameOver = true;
    if (score > highScore) {
        highScore = score;
        localStorage.setItem('flappyHighScore', highScore);
    }
}

// Draw Game
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Sky
    ctx.fillStyle = '#70c5ce';
    ctx.fillRect(0, 0, 400, 520);

    // Ground
    ctx.fillStyle = '#ded895';
    ctx.fillRect(0, 520, 400, 80);

    // Bird
    ctx.save();
    ctx.translate(bird.x + bird.w / 2, bird.y + bird.h / 2);
    ctx.rotate(Math.min(Math.max(bird.vy * 0.1, -0.3), 1));
    if (birdImg.complete) {
        ctx.drawImage(birdImg, -bird.w/2, -bird.h/2, bird.w, bird.h);
    } else {
        ctx.fillStyle = 'yellow';
        ctx.fillRect(-bird.w/2, -bird.h/2, bird.w, bird.h);
    }
    ctx.restore();

    // Pipes
    ctx.fillStyle = '#5b9a4c';
    for (let p of pipes) {
        ctx.fillRect(p.x, 0, 52, p.top);
        ctx.fillRect(p.x, p.top + 180, 52, 520 - p.top - 180);
    }

    // Score
    ctx.fillStyle = '#000';
    ctx.font = '36px Arial';
    ctx.fillText('Score: ' + score, 20, 50);
    ctx.fillText('Best: ' + highScore, 230, 50);

    // Game Over Screen
    if (gameOver) {
        ctx.fillStyle = 'rgba(0,0,0,0.7)';
        ctx.fillRect(0, 0, 400, 600);
        ctx.fillStyle = '#fff';
        ctx.font = '36px Arial';
        ctx.fillText('GAME OVER', 85, 260);
        ctx.font = '24px Arial';
        ctx.fillText('Score: ' + score, 145, 310);
        ctx.fillText('High Score: ' + highScore, 115, 350);
        ctx.fillText('Tap / Space to Restart', 75, 400);
    }
}

// Game Loop
function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();

// Screen Scaling Fix
function resizeCanvas() {
    const scale = Math.min(
        window.innerWidth / canvas.width,
        window.innerHeight / canvas.height
    );
    canvas.style.transform = `scale(${scale})`;
    canvas.style.transformOrigin = 'center center';
}

window.addEventListener('resize', resizeCanvas);
resizeCanvas();
</script>

</body>
</html>
